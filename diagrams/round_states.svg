<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1606px" preserveAspectRatio="none" style="width:936px;height:1606px;" version="1.1" viewBox="0 0 936 1606" width="936px" zoomAndPan="magnify"><defs><filter height="300%" id="f15qnl0mqnm3qg" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FEFECE" filter="url(#f15qnl0mqnm3qg)" height="40" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="220" y="89"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="225" y="113.8467">Input Registration</text><rect fill="#FEFECE" filter="url(#f15qnl0mqnm3qg)" height="46.2969" style="stroke: #000000; stroke-width: 1.5;" width="155" x="208.5" y="190"/><path d="M260.1667,191 L260.1667,195 L253.1667,202 L208.5,202 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="223.5" y="222.9951">Input Registered</text><rect fill="#FEFECE" filter="url(#f15qnl0mqnm3qg)" height="40" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="181" x="368.5" y="398"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="171" x="373.5" y="422.8467">Connection Confirmation</text><rect fill="#FEFECE" filter="url(#f15qnl0mqnm3qg)" height="46.2969" style="stroke: #000000; stroke-width: 1.5;" width="150" x="239" y="499"/><path d="M289,500 L289,504 L282,511 L239,511 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="110" x="254" y="531.9951">Input Confirmed</text><rect fill="#FEFECE" filter="url(#f15qnl0mqnm3qg)" height="40" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="145" x="373.5" y="723"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="135" x="378.5" y="747.8467">Output Registration</text><rect fill="#FEFECE" filter="url(#f15qnl0mqnm3qg)" height="46.2969" style="stroke: #000000; stroke-width: 1.5;" width="168" x="208" y="824"/><path d="M264,825 L264,829 L257,836 L208,836 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="223" y="856.9951">Output Registered</text><rect fill="#FEFECE" filter="url(#f15qnl0mqnm3qg)" height="40" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="146" x="464" y="1048"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="136" x="469" y="1072.8467">Transaction Signing</text><path d="M59.5,1048 L59.5,1088.2656 A0,0 0 0 0 59.5,1088.2656 L428.5,1088.2656 A0,0 0 0 0 428.5,1088.2656 L428.5,1072 L463.7154,1068 L428.5,1064 L428.5,1058 L418.5,1048 L59.5,1048 A0,0 0 0 0 59.5,1048 " fill="#FBFB77" filter="url(#f15qnl0mqnm3qg)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M418.5,1048 L418.5,1058 L428.5,1058 L418.5,1048 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="348" x="65.5" y="1065.0669">If signing times out a new MAC key must be generated</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="301" x="65.5" y="1080.1997">and only signing inputs permitted to re-register</text><rect fill="#FEFECE" filter="url(#f15qnl0mqnm3qg)" height="46.2969" style="stroke: #000000; stroke-width: 1.5;" width="127" x="479.5" y="1165"/><path d="M521.8333,1166 L521.8333,1170 L514.8333,1177 L479.5,1177 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="87" x="494.5" y="1197.9951">Input Signed</text><rect fill="#FEFECE" filter="url(#f15qnl0mqnm3qg)" height="40" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="165" x="351.5" y="1373"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="155" x="356.5" y="1397.8467">Transaction Broadcast</text><polygon fill="#FEFECE" filter="url(#f15qnl0mqnm3qg)" points="434,297,446,309,434,321,422,309,434,297" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#FEFECE" filter="url(#f15qnl0mqnm3qg)" points="340,622,352,634,340,646,328,634,340,622" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#FEFECE" filter="url(#f15qnl0mqnm3qg)" points="446,947,458,959,446,971,434,959,446,947" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#FEFECE" filter="url(#f15qnl0mqnm3qg)" points="434,1272,446,1284,434,1296,422,1284,434,1272" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#FEFECE" filter="url(#f15qnl0mqnm3qg)" points="628,297,640,309,628,321,616,309,628,297" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#FEFECE" filter="url(#f15qnl0mqnm3qg)" points="648,622,660,634,648,646,636,634,648,622" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#FEFECE" filter="url(#f15qnl0mqnm3qg)" points="434,1482,446,1494,434,1506,422,1494,434,1482" style="stroke: #A80036; stroke-width: 1.5;"/><path d="M96.5,1474 L96.5,1514.2656 A0,0 0 0 0 96.5,1514.2656 L387.5,1514.2656 A0,0 0 0 0 387.5,1514.2656 L387.5,1498 L421.6484,1494 L387.5,1490 L387.5,1484 L377.5,1474 L96.5,1474 A0,0 0 0 0 96.5,1474 " fill="#FBFB77" filter="url(#f15qnl0mqnm3qg)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M377.5,1474 L377.5,1484 L387.5,1484 L377.5,1474 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="270" x="102.5" y="1491.0669">If broadcast fails, only inptus which weren't</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="267" x="102.5" y="1506.1997">double spent are  permitted to re-register</text><ellipse cx="286" cy="18" fill="#000000" filter="url(#f15qnl0mqnm3qg)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><ellipse cx="663" cy="1585" fill="none" filter="url(#f15qnl0mqnm3qg)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="663.5" cy="1585.5" fill="#000000" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><!--link *start to in--><path d="M286,28.0863 C286,41.4526 286,65.4896 286,83.9036 " fill="none" id="*start-in" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="286,88.9346,290,79.9346,286,83.9346,282,79.9346,286,88.9346" style="stroke: #A80036; stroke-width: 1.0;"/><!--link in to regin--><path d="M286,129.0522 C286,144.7789 286,166.8709 286,184.4445 " fill="none" id="in-regin" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="286,189.7413,290,180.7413,286,184.7413,282,180.7413,286,189.7413" style="stroke: #A80036; stroke-width: 1.0;"/><!--link regin to c1--><path d="M321.8267,236.2389 C354.4355,257.3906 400.6628,287.3759 422.1581,301.3188 " fill="none" id="regin-c1" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="426.5942,304.1962,421.2203,295.9426,422.3994,301.4752,416.8668,302.6543,426.5942,304.1962" style="stroke: #A80036; stroke-width: 1.0;"/><!--link in to c5--><path d="M352.0482,118.6661 C406.2588,129.1485 482.9474,150.0475 539,190 C579.4032,218.7981 609.3302,271.488 621.7188,295.9192 " fill="none" id="in-c5" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="624.0936,300.6849,623.6595,290.8456,621.8635,296.2098,616.4993,294.4138,624.0936,300.6849" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="584" y="217.5669">timeout</text><!--link c5 to conf--><path d="M623.3703,316.9332 C615.7603,329.3604 599.4905,353.4931 580,368 C564.7501,379.3506 546.5495,388.6215 528.9539,395.9599 " fill="none" id="c5-conf" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="524.0101,397.9786,533.8544,398.2795,528.6391,396.0885,530.8301,390.8732,524.0101,397.9786" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="599" y="364.0669">[registered &gt;= min]</text><!--link c5 to *end--><path d="M638.8057,310.3285 C677.235,315.7108 805,339.5074 805,418 C805,418 805,418 805,1494 C805,1553.7233 714.8562,1576.0454 678.2133,1582.652 " fill="none" id="c5-*end" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="673.2123,1583.5153,682.7616,1585.926,678.1394,1582.6647,681.4007,1578.0426,673.2123,1583.5153" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="806" y="963.5669">[registered &lt; min]</text><!--link c1 to in--><path d="M431.3888,299.6092 C425.1966,278.4822 408.081,226.2295 381,190 C364.2308,167.5658 340.1841,147.1408 320.4802,132.4132 " fill="none" id="c1-in" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="316.0891,129.1709,320.9534,137.7347,320.1115,132.1409,325.7053,131.2989,316.0891,129.1709" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="408" y="217.5669">[registered &lt; max]</text><!--link c1 to conf--><path d="M434.5854,320.4444 C435.3774,332.4301 437.1608,351.7369 441,368 C442.966,376.3281 445.8702,385.1849 448.7747,393.094 " fill="none" id="c1-conf" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="450.5748,397.8828,451.1523,388.0509,448.8155,393.2025,443.6639,390.8657,450.5748,397.8828" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="442" y="364.0669">[registered == max]</text><!--link conf to c6--><path d="M487.1238,438.153 C507.5153,453.5247 535.071,475.9226 556,499 C593.1543,539.9682 627.0862,596.853 641.1473,621.6361 " fill="none" id="conf-c6" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="643.6896,626.1504,642.7586,616.3456,641.2361,621.7938,635.788,620.2713,643.6896,626.1504" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="592" y="526.5669">timeout</text><!--link c6 to *end--><path d="M650.2782,643.8566 C654.4744,662.9018 663,706.1332 663,743 C663,743 663,743 663,1494 C663,1520.6305 663,1551.6448 663,1569.7241 " fill="none" id="c6-*end" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="663,1574.9005,667,1565.9005,663,1569.9005,659,1565.9005,663,1574.9005" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="664" y="1131.0669">[confirmed &lt; min]</text><!--link c6 to out--><path d="M636.9205,635.2492 C611.9848,638.4771 550.2577,648.8271 507,676 C489.4958,686.9955 473.8892,704.3562 462.8441,718.6505 " fill="none" id="c6-out" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="459.5657,722.9777,468.1889,718.2195,462.5851,718.9923,461.8123,713.3885,459.5657,722.9777" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="508" y="689.0669">[confirmed &gt;= min]</text><!--link conf to confin--><path d="M431.0425,438.0522 C408.093,454.5126 375.4215,477.946 350.4265,495.8734 " fill="none" id="conf-confin" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="346.169,498.9271,355.8137,496.9321,350.232,496.013,351.1511,490.4313,346.169,498.9271" style="stroke: #A80036; stroke-width: 1.0;"/><!--link confin to c2--><path d="M319.3872,545.2065 C324.5537,567.4619 332.1969,600.3867 336.5787,619.2619 " fill="none" id="confin-c2" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="337.7233,624.1926,339.5844,614.5212,336.5926,619.3221,331.7916,616.3303,337.7233,624.1926" style="stroke: #A80036; stroke-width: 1.0;"/><!--link c2 to conf--><path d="M345.7307,627.4643 C357.9922,613.2457 387.1834,578.1155 406,545 C425.1432,511.3098 441.3033,469.3329 450.5765,443.0919 " fill="none" id="c2-conf" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="452.3382,438.0606,445.5886,445.233,450.6858,442.7797,453.1391,447.8768,452.3382,438.0606" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="430" y="526.5669">[unconfirmed &gt; 0]</text><!--link c2 to out--><path d="M336.589,642.8144 C332.4437,655.112 327.1429,677.6336 337,693 C344.709,705.0176 356.1098,714.1847 368.6712,721.166 " fill="none" id="c2-out" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="373.3469,723.6404,367.2633,715.8951,368.9276,721.3016,363.5212,722.9659,373.3469,723.6404" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="338" y="689.0669">[unconfirmed == 0]</text><!--link out to regout--><path d="M416.3073,763.0522 C391.8326,779.5806 356.9469,803.1398 330.3588,821.0954 " fill="none" id="out-regout" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="326.1656,823.9271,335.8627,822.205,330.3092,821.1288,331.3854,815.5753,326.1656,823.9271" style="stroke: #A80036; stroke-width: 1.0;"/><!--link regout to c3--><path d="M323.9089,870.2065 C358.4334,895.3152 411.631,934.0044 434.693,950.7767 " fill="none" id="regout-c3" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="438.8891,953.8284,433.9631,945.2999,434.8454,950.8876,429.2578,951.7698,438.8891,953.8284" style="stroke: #A80036; stroke-width: 1.0;"/><!--link c3 to sign--><path d="M446.7264,970.4471 C448.0366,983.1378 451.7091,1003.7005 462,1018 C469.6664,1028.6526 480.3591,1037.6918 491.2724,1045.0314 " fill="none" id="c3-sign" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="495.6235,1047.8642,490.2634,1039.6017,491.4333,1045.1362,485.8987,1046.306,495.6235,1047.8642" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="463" y="1014.0669">[balance == 0]</text><!--link c3 to out--><path d="M446,946.8431 C446,912.6575 446,815.1444 446,768.4826 " fill="none" id="c3-out" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="446,763.3208,442,772.3208,446,768.3208,450,772.3208,446,763.3208" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="447" y="851.5669">[balance &gt; 0]</text><!--link out to sign--><path d="M481.4517,763.0964 C502.9369,777.245 528.8503,798.2299 543,824 C584.789,900.1081 588.5555,934.1548 566,1018 C563.6685,1026.6669 559.4265,1035.3808 554.8934,1043.0509 " fill="none" id="out-sign" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="552.0478,1047.6821,560.1676,1042.1082,554.6654,1043.4221,553.3515,1037.9199,552.0478,1047.6821" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="579" y="913.0669">timeout</text><!--link sign to sig--><path d="M538.0043,1088.0853 C538.9864,1107.7278 540.4908,1137.8155 541.5921,1159.8422 " fill="none" id="sign-sig" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="541.8487,1164.9749,545.3942,1155.7864,541.599,1159.9811,537.4042,1156.1859,541.8487,1164.9749" style="stroke: #A80036; stroke-width: 1.0;"/><!--link sig to c4--><path d="M516.6141,1211.2389 C493.3808,1231.7013 460.7607,1260.4309 444.3262,1274.9054 " fill="none" id="sig-c4" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="440.5122,1278.2645,449.9099,1275.3177,444.2644,1274.9598,444.6223,1269.3142,440.5122,1278.2645" style="stroke: #A80036; stroke-width: 1.0;"/><!--link c4 to sign--><path d="M426.9563,1279.0053 C404.7587,1262.6362 339.2235,1209.1297 365,1165 C386.1815,1128.737 426.4757,1104.9681 462.7411,1090.0394 " fill="none" id="c4-sign" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="467.5993,1088.0817,457.7565,1087.7355,462.9617,1089.9505,460.7466,1095.1557,467.5993,1088.0817" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="366" y="1192.5669">[unsigned &gt; 0]</text><!--link c4 to bcast--><path d="M434,1296.0814 C434,1313.2205 434,1345.0071 434,1367.4979 " fill="none" id="c4-bcast" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="434,1372.7155,438,1363.7155,434,1367.7155,430,1363.7155,434,1372.7155" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="435" y="1339.0669">[unsigned == 0]</text><!--link sign to in--><path d="M463.7985,1050.8559 C352.8784,1024.3663 155,974.8838 155,959 C155,213 155,213 155,213 C155,174.3705 190.3731,147.8053 224.3569,131.1971 " fill="none" id="sign-in" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="228.9226,129.0201,219.0773,129.2832,224.4094,131.1721,222.5205,136.5043,228.9226,129.0201" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="156" y="588.0669">timeout</text><!--link bcast to c7--><path d="M434,1413.4389 C434,1432.0355 434,1459.1832 434,1476.7216 " fill="none" id="bcast-c7" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="434,1481.8359,438,1472.8359,434,1476.8359,430,1472.8359,434,1481.8359" style="stroke: #A80036; stroke-width: 1.0;"/><!--link c7 to *end--><path d="M442.6974,1497.4562 C477.2406,1511.1829 604.9683,1561.9394 648.419,1579.2058 " fill="none" id="c7-*end" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="653.2882,1581.1407,646.4017,1574.0997,648.6417,1579.2941,643.4472,1581.5341,653.2882,1581.1407" style="stroke: #A80036; stroke-width: 1.0;"/><!--link in to c7--><path d="M214.5977,120.9828 C131.6405,136.976 6,168.5374 6,213 C6,213 6,213 6,1393 C6,1483.4753 321.738,1438.5992 405,1474 C413.3299,1477.5417 421.721,1483.6729 427.3184,1488.2157 " fill="none" id="in-c7" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="219.9985,119.9519,210.4081,117.7104,215.0872,120.8894,211.9082,125.5685,219.9985,119.9519" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml

hide empty description
state "Input Registration" as in
state "Input Registered" as regin <<sdlreceive>>
state "Connection Confirmation" as conf
state "Input Confirmed" as confin <<sdlreceive>>
state "Output Registration" as out
state "Output Registered" as regout <<sdlreceive>>
state "Transaction Signing" as sign
note left of sign
    If signing times out a new MAC key must be generated
    and only signing inputs permitted to re-register
end note
state "Input Signed" as sig <<sdlreceive>>
state "Transaction Broadcast" as bcast
state c1 <<choice>>
state c2 <<choice>>
state c3 <<choice>>
state c4 <<choice>>
state c5 <<choice>>
state c6 <<choice>>
state c7 <<choice>>
note left of c7
    If broadcast fails, only inptus which weren't
    double spent are  permitted to re-register
end note

[*] - -> in
in - -> regin
regin - -> c1
in - -> c5 : timeout
c5 - -> conf : [registered >= min]
c5 - -> [*] : [registered < min]
c1 - -> in : [registered < max]
c1 - -> conf : [registered == max]
conf - -> c6 : timeout
c6 - -> [*] : [confirmed < min]
c6 - -> out : [confirmed >= min]
conf - -> confin
confin - -> c2
c2 - -> conf  : [unconfirmed > 0]
c2 - -> out : [unconfirmed == 0]
out - -> regout
regout - -> c3
c3 - -> sign : [balance == 0]
c3 - -> out : [balance > 0]
out - -> sign : timeout
sign - -> sig
sig - -> c4
c4 - -> sign : [unsigned > 0]
c4 - -> bcast : [unsigned == 0]
sign - -> in  : timeout
bcast - -> c7
c7 - -> [*]
c7 -up-> in



regin: nonempty description
confin: nonempty description
regout: nonempty description
sig: nonempty description

@enduml

PlantUML version 1.2018.13(Mon Nov 26 17:11:51 UTC 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.7+10-post-Debian-3deb10u1
Operating System: Linux
OS Version: 5.5.7-1.qubes.x86_64
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>