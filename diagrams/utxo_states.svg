<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="920px" preserveAspectRatio="none" style="width:803px;height:920px;" version="1.1" viewBox="0 0 803 920" width="803px" zoomAndPan="magnify"><defs><filter height="300%" id="f17zqho4or7e3j" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--cluster round--><rect fill="#FEFECE" filter="url(#f17zqho4or7e3j)" height="539" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="396" x="14" y="16"/><rect fill="#FFFFFF" height="506.7031" rx="12.5" ry="12.5" style="stroke: #FFFFFF; stroke-width: 1.0;" width="390" x="17" y="45.2969"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="14" x2="410" y1="42.2969" y2="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="151.5" y="32.9951">Coordinator State</text><rect fill="#FEFECE" filter="url(#f17zqho4or7e3j)" height="40" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="298" y="43"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="303" y="67.8467">Registered</text><rect fill="#FEFECE" filter="url(#f17zqho4or7e3j)" height="40" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="283.5" y="143"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="288.5" y="167.8467">Confirmed</text><rect fill="#FEFECE" filter="url(#f17zqho4or7e3j)" height="40" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="344" y="319"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="349" y="343.8467">Signed</text><polygon fill="#FEFECE" filter="url(#f17zqho4or7e3j)" points="297,327,309,339,297,351,285,339,297,327" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f17zqho4or7e3j)" height="40" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="64" x="249" y="507"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="54" x="254" y="531.8467">Banned</text><path d="M22,243 L22,434.5938 A0,0 0 0 0 22,434.5938 L250,434.5938 A0,0 0 0 0 250,434.5938 L250,343 L284.9206,339 L250,335 L250,253 L240,243 L22,243 A0,0 0 0 0 22,243 " fill="#FBFB77" filter="url(#f17zqho4or7e3j)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M240,243 L240,253 L250,253 L240,243 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="28" y="260.0669">DoS prevention policy</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="32" y="275.1997"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="28" y="290.3325">De-registration and timeouts</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="28" y="305.4653">follow this path, since</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="28" y="320.5981">repeated de-registration may</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="28" y="335.731">suggest a DoS attack</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="32" y="350.8638"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="28" y="365.9966">Repeated non-signing inputs</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="28" y="381.1294">strongly suggests DoS attempts</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="28" y="396.2622">but there's always plausible</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="189" x="28" y="411.395">deniability due to connectivity</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="28" y="426.5278">issues, so bans should expire.</text><rect fill="#FEFECE" filter="url(#f17zqho4or7e3j)" height="64.2344" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="508" y="307"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="508" x2="600" y1="333.2969" y2="333.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="526.5" y="324.9951">Created</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="62" x="513" y="349.4355">funding tx</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="72" x="513" y="363.4043">in mempool</text><path d="M635,251 L635,335 L600.2715,339 L635,343 L635,427.4609 A0,0 0 0 0 635,427.4609 L791,427.4609 A0,0 0 0 0 791,427.4609 L791,261 L781,251 L635,251 A0,0 0 0 0 635,251 " fill="#FBFB77" filter="url(#f17zqho4or7e3j)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M781,251 L781,261 L791,261 L781,251 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="641" y="268.0669">A child of a banned</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="641" y="283.1997">input may start in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="641" y="298.3325">the banned stated.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="645" y="313.4653"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="641" y="328.5981">For simplicity, and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="641" y="343.731">because destroying</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="641" y="358.8638">UTXOs incurs a cost,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="641" y="373.9966">we illustrate a DoS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="641" y="389.1294">policy that doesn't</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="641" y="404.2622">take provenance into</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="641" y="419.395">account.</text><rect fill="#FEFECE" filter="url(#f17zqho4or7e3j)" height="64.2344" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="82" x="419" y="495"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="419" x2="501" y1="521.2969" y2="521.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="439" y="512.9951">Mined</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="62" x="424" y="537.4355">funding tx</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="62" x="424" y="551.4043">confirmed</text><rect fill="#FEFECE" filter="url(#f17zqho4or7e3j)" height="64.2344" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="407.5" y="754"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="407.5" x2="500.5" y1="780.2969" y2="780.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="418" y="771.9951">Destroyed</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="73" x="412.5" y="796.4355">spending tx</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="62" x="412.5" y="810.4043">confirmed</text><path d="M195.5,743 L195.5,828.6641 A0,0 0 0 0 195.5,828.6641 L372.5,828.6641 A0,0 0 0 0 372.5,828.6641 L372.5,790 L407.2887,786 L372.5,782 L372.5,753 L362.5,743 L195.5,743 A0,0 0 0 0 195.5,743 " fill="#FBFB77" filter="url(#f17zqho4or7e3j)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M362.5,743 L362.5,753 L372.5,753 L362.5,743 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="201.5" y="760.0669">For simplicity reorgs</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="201.5" y="775.1997">are not shown, so the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="201.5" y="790.3325">mined and destroyed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="201.5" y="805.4653">states assume sufficient</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="201.5" y="820.5981">confirmation depth.</text><rect fill="#FEFECE" filter="url(#f17zqho4or7e3j)" height="64.2344" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="407.5" y="619"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="407.5" x2="500.5" y1="645.2969" y2="645.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="433.5" y="636.9951">Spent</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="73" x="412.5" y="661.4355">spending tx</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="72" x="412.5" y="675.4043">in mempool</text><ellipse cx="554" cy="163" fill="#000000" filter="url(#f17zqho4or7e3j)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><ellipse cx="504" cy="899" fill="none" filter="url(#f17zqho4or7e3j)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="504.5" cy="899.5" fill="#000000" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><!--link ireg to cconf--><path d="M337.5598,83.2365 C334.8869,98.9595 331.1644,120.8563 328.2958,137.7304 " fill="none" id="ireg-cconf" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="327.4351,142.7936,332.8869,134.5913,328.2731,137.8643,325.0001,133.2505,327.4351,142.7936" style="stroke: #A80036; stroke-width: 1.0;"/><!--link cconf to signed--><path d="M329.6209,183.1894 C338.6058,215.4618 356.1861,278.6072 365.9824,313.794 " fill="none" id="cconf-signed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="367.3694,318.7757,368.8087,309.0326,366.0282,313.9589,361.1019,311.1784,367.3694,318.7757" style="stroke: #A80036; stroke-width: 1.0;"/><!--link cconf to nc--><path d="M320.9028,183.1894 C315.4556,218.6968 304.2751,291.5768 299.3819,323.4734 " fill="none" id="cconf-nc" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="298.5981,328.5826,303.9167,320.2933,299.3564,323.6404,296.0092,319.0801,298.5981,328.5826" style="stroke: #A80036; stroke-width: 1.0;"/><!--link signed to ireg--><path d="M377.5719,318.8966 C384.9358,282.9978 397.143,205.7492 382,143 C377.2553,123.3391 366.8076,103.0828 357.6467,87.8722 " fill="none" id="signed-ireg" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="354.8527,83.32,356.1513,93.0829,357.4681,87.5814,362.9696,88.8982,354.8527,83.32" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ireg to nc--><path d="M313.666,83.0655 C296.3964,97.5396 275.5913,118.7456 266,143 C252.7843,176.4196 281.699,285.5463 292.8515,324.7851 " fill="none" id="ireg-nc" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="294.2409,329.6345,295.6073,319.8809,292.8637,324.8279,287.9167,322.0843,294.2409,329.6345" style="stroke: #A80036; stroke-width: 1.0;"/><!--link mined to ireg--><path d="M459.6682,494.9023 C457.8775,427.0159 447.8025,265.0999 394,143 C385.2189,123.072 371.5877,102.6379 360.3484,87.4098 " fill="none" id="mined-ireg" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="357.2478,83.2575,359.4274,92.8621,360.2393,87.2639,365.8376,88.0757,357.2478,83.2575" style="stroke: #A80036; stroke-width: 1.0;"/><!--link signed to spent--><path d="M372.9393,359.0046 C373.3804,398.3677 377.176,488.2063 401,559 C407.5025,578.3225 418.2792,598.1212 428.423,614.3781 " fill="none" id="signed-spent" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="431.2632,618.8661,429.8304,609.122,428.5894,614.6411,423.0704,613.4001,431.2632,618.8661" style="stroke: #A80036; stroke-width: 1.0;"/><!--link signed to mined--><path d="M382.3105,359.1193 C396.7587,390.3406 424.8007,450.9371 442.9468,490.1493 " fill="none" id="signed-mined" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="445.1091,494.8219,444.9593,484.9742,443.0091,490.2843,437.6991,488.3341,445.1091,494.8219" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nc to banned--><path d="M296.047,350.1972 C293.5309,379.7618 286.6617,460.4751 283.1416,501.8358 " fill="none" id="nc-banned" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="282.709,506.9197,287.4578,498.2913,283.133,501.9377,279.4866,497.6129,282.709,506.9197" style="stroke: #A80036; stroke-width: 1.0;"/><!--link nc to mined--><path d="M297.9389,350.1462 C300.0385,369.2325 306.5712,408.6582 326,435 C353.321,472.0421 374.2628,468.1774 414.3687,494.6444 " fill="none" id="nc-mined" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="418.8303,497.6618,413.6161,489.3064,414.6886,494.8607,409.1343,495.9331,418.8303,497.6618" style="stroke: #A80036; stroke-width: 1.0;"/><!--link banned to mined--><path d="M313.1641,527 C346.6478,527 380.1315,527 413.6152,527 " fill="none" id="banned-mined" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="418.9892,527,409.9892,523,413.9892,527,409.9892,531,418.9892,527" style="stroke: #A80036; stroke-width: 1.0;"/><!--link banned to destroyed--><path d="M294.575,547.3233 C323.7647,591.0234 392.8388,694.435 429.7516,749.6975 " fill="none" id="banned-destroyed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="432.5698,753.9167,430.897,744.2109,429.7926,749.7589,424.2446,748.6545,432.5698,753.9167" style="stroke: #A80036; stroke-width: 1.0;"/><!--link *start to created--><path d="M554,173.2232 C554,197.6571 554,260.448 554,301.3562 " fill="none" id="*start-created" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="554,306.7285,558,297.7285,554,301.7285,550,297.7285,554,306.7285" style="stroke: #A80036; stroke-width: 1.0;"/><!--link created to mined--><path d="M537.8408,371.3184 C521.313,404.3741 495.6751,455.6498 478.3825,490.235 " fill="none" id="created-mined" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="476.1053,494.7894,483.7079,488.5283,478.3413,490.3172,476.5524,484.9507,476.1053,494.7894" style="stroke: #A80036; stroke-width: 1.0;"/><!--link mined to spent--><path d="M447.0949,559.2558 C444.5858,575.9039 443.4437,596.3018 443.9982,613.633 " fill="none" id="mined-spent" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="444.2252,618.9057,447.8342,609.7419,444.0101,613.9103,439.8416,610.0862,444.2252,618.9057" style="stroke: #A80036; stroke-width: 1.0;"/><!--link spent to mined--><path d="M467.5471,618.9057 C470.1657,602.2819 471.3275,581.8863 470.7026,564.5353 " fill="none" id="spent-mined" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="470.4509,559.2558,466.8841,568.4361,470.689,564.2501,474.875,568.0551,470.4509,559.2558" style="stroke: #A80036; stroke-width: 1.0;"/><!--link spent to destroyed--><path d="M454,683.3359 C454,703.0394 454,728.2892 454,748.817 " fill="none" id="spent-destroyed" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="454,753.928,458,744.928,454,748.928,450,744.928,454,753.928" style="stroke: #A80036; stroke-width: 1.0;"/><!--link created to *end--><path d="M553.0146,371.249 C550.3126,449.8466 541.3681,657.4276 518,829 C515.4013,848.0802 510.7999,869.7853 507.5841,883.9006 " fill="none" id="created-*end" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="506.3847,889.0966,512.3067,881.227,507.5094,884.2247,504.5117,879.4275,506.3847,889.0966" style="stroke: #A80036; stroke-width: 1.0;"/><!--link destroyed to *end--><path d="M468.1943,818.079 C477.9275,840.0762 490.3668,868.189 497.7287,884.8268 " fill="none" id="destroyed-*end" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="499.8417,889.6023,499.8576,879.7535,497.8184,885.03,492.5419,882.9907,499.8417,889.6023" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml

hide empty description

state "Created" as created
created: funding tx
created: in mempool
note right of created
    A child of a banned
    input may start in
    the banned stated.
    
    For simplicity, and
    because destroying
    UTXOs incurs a cost,
    we illustrate a DoS
    policy that doesn't
    take provenance into
    account.
end note
state "Mined" as mined
mined: funding tx
mined: confirmed
note left of destroyed
    For simplicity reorgs
    are not shown, so the
    mined and destroyed
    states assume sufficient
    confirmation depth.
end note
state "Spent" as spent
spent: spending tx
spent: in mempool
state "Destroyed" as destroyed
destroyed: spending tx
destroyed: confirmed


state "Coordinator State" as round {
    state "Registered" as ireg
    state "Confirmed" as cconf
    state "Signed" as signed
    state nc <<choice>>
    state "Banned" as banned
    
    ireg - -> cconf
    cconf - -> signed
    cconf - -> nc
    signed - -> ireg

    ireg - -> nc
    
    mined - -> ireg
    signed - -> spent
    signed - -> mined
    
    nc - -> banned
    nc - -> mined
    note left of nc
        DoS prevention policy
        
        De-registration and timeouts
        follow this path, since
        repeated de-registration may
        suggest a DoS attack
        
        Repeated non-signing inputs
        strongly suggests DoS attempts
        but there's always plausible
        deniability due to connectivity
        issues, so bans should expire.
    end note

    banned - -> mined
    banned - -> destroyed
}
[*] - -> created
created - -> mined
mined - -> spent
spent - -> destroyed
spent - -> mined
created - -> [*]
destroyed - -> [*]

@enduml

PlantUML version 1.2018.13(Mon Nov 26 17:11:51 UTC 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.7+10-post-Debian-3deb10u1
Operating System: Linux
OS Version: 5.5.7-1.qubes.x86_64
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>